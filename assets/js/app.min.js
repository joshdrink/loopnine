$(document).ready(function(){function t(){var t=$(window).height(),e=$(window).width();$(".grid").css("width",t+"px"),$(".menu").css("width",e-t+"px");var i=$(".art").width();$(".row").css("height",i+"px")}function e(t){var e=$(t).width(),i=parseInt(jQuery(t).css("padding-left"),10);e>$(t).height()&&$(t).css("height",e+i+"px"),e<$(t).height()&&$(t).css("height",e+i+"px")}function o(){$(".col-square").each(function(){e(this)})}function s(){2==h&&$(".loader, .shade").hide()}function a(t){text=Math.floor(26*Math.random())+1,10>text?$('.art[data-grid-id="'+t+'"]').append("<img class='text' src='/assets/img/text_0"+text+".png'>"):$('.art[data-grid-id="'+t+'"]').append("<img class='text' src='/assets/img/text_"+text+".png'>"),$('.art[data-grid-id="'+t+'"]').addClass("active"),loopList[t].object.volume=.5,loopList[t].object.gainNode.gain.value=.5}function n(t){abs=Math.abs(t),$('.art[data-grid-id="'+abs+'"] .text').remove(),$('.art[data-grid-id="'+abs+'"]').removeClass("active"),loopList[t].object.volume=0,loopList[t].object.gainNode.gain.value=0}function d(){for(var t=1;10>t;t++)$('.art[data-grid-id="'+t+'"] .wrapper img').attr("src","/assets/img/"+loopList[t].image),$('.art[data-grid-id="'+t+'"] .wrapper p').text(loopList[t].text).append($("<span></span>").text(loopList[t].song).addClass("song-text")),$('.art[data-grid-id="'+t+'"]').data("loop",loopList[t].loopname)}function r(){for(i=1;27>i;i++)$("<img/>")[0].src=10>i?"/assets/img/text_0"+i+".png":"/assets/img/text_"+i+".png";totalImages=$("img").length,loadedImages=0,$("img").each(function(){this.complete?(loadedImages++,loadedImages==totalImages&&(h++,s())):$(this).one("load",function(){loadedImages++,loadedImages==totalImages&&(h++,s())})})}function u(t){this.url="/assets/sound/"+t.url,this.loaded=!1,this.volume=0,this.length=4,this.bar_counter=1,this.load_buffer=function(){this.buffer_request=new XMLHttpRequest,this.buffer_request.open("GET",this.url,!0),this.buffer_request.responseType="arraybuffer";var t=this;this.buffer_request.onload=function(){context.decodeAudioData(t.buffer_request.response,function(e){t.audio_buffer=e,t.cue_sound(),console.log("loaded")})},this.buffer_request.send()},this.cue_sound=function(){this.loaded=!0;var t=new CustomEvent("loop_cued",{detail:{loop:this}});window.dispatchEvent(t)},this.playSound=function(){this.buffer_source=context.createBufferSource(),this.buffer_source.buffer=this.audio_buffer,this.gainNode=context.createGain(),this.buffer_source.connect(this.gainNode),this.gainNode.connect(context.destination),this.buffer_source.loop=!0,this.gainNode.gain.value=this.volume,this.buffer_source.start(0)},this.load_buffer()}$(function(){setTimeout(t,20),$(window).resize(t)}),$(function(){setTimeout(o,20),$(window).resize(o)});try{window.AudioContext=window.AudioContext||window.webkitAudioContext,context=new AudioContext}catch(c){alert("Web Audio API is not supported in this browser")}$(".art").on("click",function(t){parent=$(t.target).closest(".art"),parent.hasClass("active")?n(parent.data("grid-id")):a(parent.data("grid-id"))}),d();var h=0;r(),this.cued_loops=0,this.loops=[],$.each(loopList,function(){this.object=new u(this)}),__this=this,window.addEventListener("loop_cued",function(){if(__this.cued_loops++,9==__this.cued_loops){for(var t=1;10>t;t++)loopList[t].object.playSound();h++,s()}})});